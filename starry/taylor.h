/**
Taylor expansions for the solver module.

*/

#ifndef _STARRY_TAYLOR_H_
#define _STARRY_TAYLOR_H_

#include <iostream>
#include <cmath>
#include "errors.h"
#include "fact.h"
#include "ellip.h"

namespace solver
{
    template <class T>
    class Greens;
    bool is_even(int n, int ntimes);
    template <typename T>
    inline T step(T x);
};

namespace taylor {


    /*
    template <typename T>
    inline T s2_b_equLS_R(solver::Greens<T>& G, int u, int v) {
    // Use transformation of 17.7.14 in Abramowitz & Stegun:
    one_minus_n = (b-r).^2.*(1.0-(b+r).^2)./(1.0-(b-r).^2)./(b+r).^2
    kofk = ellk_bulirsch.(1./k2); eofk = ellec_bulirsch.(1./k2)
    phi= asin.(sqrt.(one_minus_n./(1.-1./k2)))
    mc = 1.-1./k2
    // Compute Heuman's Lambda Function via A&S 17.4.40:
    lam = 2./pi*(kofk.*Elliptic.E.(phi,mc)-(kofk-eofk).*Elliptic.F.(phi,mc))
    d2 = sqrt.((1.0./one_minus_n-1.0)./(1.0-one_minus_n-1./k2))
    # Equation 17.7.14 in A&S:
    pi2 = 3.0*(b-r).*(b+r-1./(b+r)).*(kofk+pi/2.*d2.*(1.-lam))
    # Overplot for comparison:
    plot(b,pi2,linewidth=3,label="Transformed expression")
    xlabel("b"); ylabel(L"$3(b-r)(b+r-(b+r)^{-1}) \Pi(k^{-2}(b+r)^{-2},k)$")
    legend(loc="lower left")
    }
    */

    // Taylor expand the difference between the elliptic integrals
    // for the s2 term when r >= 1; much more numerically stable!
    template <typename T>
    inline T s2(solver::Greens<T>& G) {
        T x = 1. / G.b_r(1);
        T eps = x - 1;
        T EP = ellip::PI(1 - 1. / ((G.b - G.r(1)) * (G.b - G.r(1))), G.ksq);
        T EminusK = -G.pi * (0.25 * G.ksq + 0.09375 * pow(G.ksq, 2) + 0.05859375 * pow(G.ksq, 3) + 0.042724609375 * pow(G.ksq, 4) +
                     0.0336456298828125 * pow(G.ksq, 5) + 0.027757644653320312 * pow(G.ksq, 6) + 0.023627042770385742 * pow(G.ksq, 7) +
                     0.020568184554576874 * pow(G.ksq, 8) + 0.018211413407698274 * pow(G.ksq, 9) + 0.016339684807462618 * pow(G.ksq, 10) +
                     0.01481712326858542 * pow(G.ksq, 11) + 0.013554300262740071 * pow(G.ksq, 12));
        T taylor = 2 * G.b * G.b * G.b * sqrt(x) * (EminusK * (16 + 28 * eps + 14 * eps * eps) - eps * eps * (2 + 3 * eps) * G.ELL.K());
        T badterm = taylor + sqrt(G.br) * ((8 - 3 / G.br + 12 / G.b_r(1)) * G.ELL.K() - 16 * G.ELL.E());
        T goodterm = (3 * (G.b + G.r(1)) / (G.b - G.r(1)) * EP) / sqrt(G.br);
        T Lambda = (badterm + goodterm) / (9 * G.pi);
        return (2. * G.pi / 3.) * (1 - 1.5 * Lambda - solver::step(G.r(1) - G.b));
    }

    // Taylor expansion about b = 0
    template <typename T>
    inline T computeJ(solver::Greens<T>& G, int u, int v) {
        T r1 = 1 - G.r(2);
        T r12 = sqrt(r1);
        T r32 = r1 * r12;
        T r52 = r1 * r32;
        T r72 = r1 * r52;
        return (r32 * G.I(u, v)) +
               (-3 * G.r(1) * r12 * G.I(u, v + 1)) * G.b +
               (-1.5 * r12 * G.I(u, v) + 1.5 * G.r(2) / r12 * G.I(u, v + 2)) * G.b2 +
               (1.5 * G.r(1) / r12 * G.I(u, v + 1) + 0.5 * G.r(3) / r32 * G.I(u, v + 3)) * G.b * G.b2 +
               (0.375 / r12 * G.I(u, v) + 0.75 * G.r(2) / r32 * G.I(u, v + 2) + 0.375 * G.r(4) / r52 * G.I(u, v + 4)) * G.b2 * G.b2 +
               (0.375 * G.r(1) / r32 * G.I(u, v + 1) + 0.75 * G.r(3) / r52 * G.I(u, v + 3) + 0.375 * G.r(5) / r72 * G.I(u, v + 5)) * G.b2 * G.b2 * G.b;
    }

    // Approximate occultor limb as a quartic function
    template <typename T>
    inline T P(solver::Greens<T>& G) {
        if (!solver::is_even(G.mu / 2, 1))
            return 0;

        // This is our old quadratic approximation; quartic is better
        /*
        T amp = 4 * pow(G.b - G.r(1), G.nu / 2) / G.r(1);
        T res = 0;
        for (int i=0; i<=G.nu/2; i++)
            res += fact::choose(G.nu / 2, i) * G.coslam(3 + 2 * i + G.mu / 2) / (G.r(i) * (6 + 4 * i + G.mu) * pow(2 * (G.b - G.r(1)), i));
        return amp * res;
        */

        // Quartic
        T res = 0;
        T amp = pow(G.b - G.r(1), G.nu / 2) / G.r(1);
        T jamp, jsum;
        T frac = (G.mu + 2.) / 4.;
        for (int i = 0; i <= G.nu / 2; i++) {
            jamp = fact::choose(G.nu / 2, i) * pow(2 * G.r(1) * (G.b - G.r(1)), -i);
            jsum = 0;
            for (int j = 0; j <= i; j++) {
                jsum += fact::choose(i, j)
                      * pow(4 * G.r(2), -j)
                      * pow(G.coslam(2), frac + i + j + 1)
                      * (1. / (frac + i + j + 1) + 0.5 * G.coslam(2) / (G.r(2) * (frac + i + j + 2)));
            }
            res += jamp * jsum;
        }
        return amp * res;

    }

    // Taylor expand M() at large k^2
    template <typename T>
    inline T computeM(solver::Greens<T>& G, int p, int q) {
        if (p == 0){
            if (q == 0) return 9.143237995419748e-11*G.ksq*G.ksq*(2.5769803776e10 + G.ksq*(2.147483648e9 + G.ksq*(6.03979776e8 + G.ksq*(2.5165824e8 + G.ksq*(1.2845056e8 + G.ksq*(7.4317824e7 + 121.*G.ksq*(387072. + 169.*G.ksq*(1536. + G.ksq*(1080. + 289.*G.ksq*(-227. + 361.*G.ksq))))))))));
            else if (q == 2) return 1.8286475990839495e-11*G.ksq*G.ksq*(1.2884901888e11 + G.ksq*(-1.073741824e10 + G.ksq*(-1.00663296e9 + G.ksq*(-2.5165824e8 + G.ksq*(-9.17504e7 + G.ksq*(-4.128768e7 + 11.*G.ksq*(-1.93536e6 + 143.*G.ksq*(-7680. + 13.*G.ksq*(-360. + 17.*G.ksq*(-3919. + 11951.*G.ksq))))))))));
            else if (q == 4) return 5.4859427972518486e-11*G.ksq*G.ksq*(4.294967296e10 + G.ksq*(-1.073741824e10 + G.ksq*(1.00663296e9 + G.ksq*(8.388608e7 + G.ksq*(1.835008e7 + G.ksq*(5.89824e6 + 11.*G.ksq*(215040. + 13.*G.ksq*(7680. + 11.*G.ksq*(360. + 221.*G.ksq*(-557. + 19.*G.ksq*(134. + 17.*G.ksq)))))))))));
            else if (q == 6) return -6.095491996946498e-12*G.ksq*G.ksq*(-3.8654705664e11 + G.ksq*(1.610612736e11 + G.ksq*(-4.52984832e10 + G.ksq*(3.7748736e9 + G.ksq*(2.752512e8 + G.ksq*(5.308416e7 + 11.*G.ksq*(1.3824e6 + 13.*G.ksq*(38400. + G.ksq*(16200. + 187.*G.ksq*(36305. + 247.*G.ksq*(-890. + G.ksq*(-297. + 68.*G.ksq))))))))))));
            else if (q == 8) return 6.095491996946498e-12*G.ksq*G.ksq*(3.8654705664e11 + G.ksq*(-2.2548578304e11 + G.ksq*(1.056964608e11 + G.ksq*(-2.64241152e10 + G.ksq*(1.9267584e9 + G.ksq*(1.2386304e8 + G.ksq*(2.128896e7 + 13.*G.ksq*(422400. + G.ksq*(138600. + 17.*G.ksq*(-2.789185e6 + 209.*G.ksq*(101045. + 13.*G.ksq*(4677. + G.ksq*(-2105. + 408.*G.ksq)))))))))))));
            else if (q == 10) return -1.8286475990839495e-11*G.ksq*G.ksq*(-1.2884901888e11 + G.ksq*(9.663676416e10 + G.ksq*(-6.341787648e10 + G.ksq*(2.64241152e10 + G.ksq*(-5.7802752e9 + G.ksq*(3.7158912e8 + G.ksq*(2.128896e7 + G.ksq*(3.29472e6 + G.ksq*(772200. + 17.*G.ksq*(8.390655e6 + 19.*G.ksq*(-3.995355e6 + 11.*G.ksq*(-333751. + 13.*G.ksq*(17137. + 4.*G.ksq*(-1647. + 272.*G.ksq))))))))))))));
            else if (q == 12) return 6.095491996946498e-12*G.ksq*G.ksq*(3.8654705664e11 + G.ksq*(-3.5433480192e11 + G.ksq*(2.9896998912e11 + G.ksq*(-1.7439916032e11 + G.ksq*(6.35830272e10 + G.ksq*(-1.226244096e10 + G.ksq*(7.0253568e8 + G.ksq*(3.624192e7 + G.ksq*(5.09652e6 + 17.*G.ksq*(-1.8365061e7 + 19.*G.ksq*(1.0246236e7 + G.ksq*(1.3084278e7 + 11.*G.ksq*(-1.049156e6 + 13.*G.ksq*(46295. + 16.*G.ksq*(-951. + 136.*G.ksq)))))))))))))));
            else if (q == 14) return -6.095491996946498e-12*G.ksq*G.ksq*(-3.8654705664e11 + G.ksq*(4.1875931136e11 + G.ksq*(-4.3184553984e11 + G.ksq*(3.2388415488e11 + G.ksq*(-1.6531587072e11 + G.ksq*(5.313724416e10 + G.ksq*(-9.13296384e9 + G.ksq*(4.7114496e8 + G.ksq*(2.208492e7 + G.ksq*(2.42426613e8 + 19.*G.ksq*(-1.52073636e8 + G.ksq*(-2.54100054e8 + G.ksq*(2.78130268e8 + 11.*G.ksq*(-1.9263227e7 + 104.*G.ksq*(91035. + 32.*G.ksq*(-811. + 102.*G.ksq))))))))))))))));
            else if (q == 16) return 1.8286475990839495e-11*G.ksq*G.ksq*(1.2884901888e11 + G.ksq*(-1.610612736e11 + G.ksq*(1.962934272e11 + G.ksq*(-1.799356416e11 + G.ksq*(1.180827648e11 + G.ksq*(-5.313724416e10 + G.ksq*(1.52216064e10 + G.ksq*(-2.3557248e9 + G.ksq*(1.104246e8 + G.ksq*(-5.8307535e7 + G.ksq*(8.55651225e8 + G.ksq*(1.791654514e9 + G.ksq*(-2.338481886e9 + G.ksq*(2.220306845e9 + 11.*G.ksq*(-1.31976185e8 + 416.*G.ksq*(135375. + 4.*G.ksq*(-8493. + 952.*G.ksq)))))))))))))))));
            else if (q == 18) return 6.095491996946498e-12*G.ksq*G.ksq*(3.8654705664e11 + G.ksq*(-5.4760833024e11 + G.ksq*(7.700742144e11 + G.ksq*(-8.342470656e11 + G.ksq*(6.691356672e11 + G.ksq*(-3.8714277888e11 + G.ksq*(1.5526038528e11 + G.ksq*(-4.00473216e10 + G.ksq*(5.6316546e9 + G.ksq*(-3.94879485e8 + G.ksq*(2.296748025e9 + G.ksq*(5.873804742e9 + G.ksq*(-8.89856279e9 + G.ksq*(1.0113472703e10 + G.ksq*(-8.251960395e9 - 88.*G.ksq*(-5.3270775e7 + 416.*G.ksq*(48127. + 2.*G.ksq*(-5385. + 544.*G.ksq))))))))))))))))));
        } else if (p == 2){
            if (q == 0) return 3.657295198167899e-11*G.ksq*G.ksq*G.ksq*(1.073741824e10 + G.ksq*(2.01326592e9 + G.ksq*(7.5497472e8 + G.ksq*(3.670016e8 + G.ksq*(2.064384e8 + 11.*G.ksq*(1.161216e7 + 143.*G.ksq*(53760. + 13.*G.ksq*(2880. + 17.*G.ksq*(-7688. + 9367.*G.ksq)))))))));
            else if (q == 2) return -1.8286475990839495e-11*G.ksq*G.ksq*G.ksq*(-2.147483648e10 + G.ksq*(4.02653184e9 + G.ksq*(5.0331648e8 + G.ksq*(1.4680064e8 + G.ksq*(5.89824e7 + 11.*G.ksq*(2.58048e6 + 13.*G.ksq*(107520. + 11.*G.ksq*(5760. + 221.*G.ksq*(2248. + 19.*G.ksq*(-227. + 51.*G.ksq))))))))));
            else if (q == 4) return 2.4381967987785993e-11*G.ksq*G.ksq*G.ksq*(1.610612736e10 + G.ksq*(-9.05969664e9 + G.ksq*(1.13246208e9 + G.ksq*(1.1010048e8 + G.ksq*(2.654208e7 + 11.*G.ksq*(829440. + 13.*G.ksq*(26880. + G.ksq*(12960. + 187.*G.ksq*(-7216. + 247.*G.ksq*(79. + G.ksq*(-36. + 17.*G.ksq)))))))))));
            else if (q == 6) return -6.095491996946498e-12*G.ksq*G.ksq*G.ksq*(-6.442450944e10 + G.ksq*(6.03979776e10 + G.ksq*(-2.26492416e10 + G.ksq*(2.2020096e9 + G.ksq*(1.769472e8 + G.ksq*(3.649536e7 + 13.*G.ksq*(844800. + G.ksq*(316800. + 17.*G.ksq*(1.60372e6 + 209.*G.ksq*(-26225. + 13.*G.ksq*(1410. + G.ksq*(-1357. + 408.*G.ksq))))))))))));
            else if (q == 8) return 1.2190983993892996e-11*G.ksq*G.ksq*G.ksq*(3.221225472e10 + G.ksq*(-4.227858432e10 + G.ksq*(2.64241152e10 + G.ksq*(-7.7070336e9 + G.ksq*(6.193152e8 + G.ksq*(4.257792e7 + G.ksq*(7.68768e6 + G.ksq*(2.0592e6 + 17.*G.ksq*(-5.54372e6 + 19.*G.ksq*(1.231685e6 + 11.*G.ksq*(-105420. + 13.*G.ksq*(12023. + 6.*G.ksq*(-1205. + 272.*G.ksq)))))))))))));
            else if (q == 10) return -6.095491996946498e-12*G.ksq*G.ksq*G.ksq*(-6.442450944e10 + G.ksq*(1.0871635968e11 + G.ksq*(-9.512681472e10 + G.ksq*(4.62422016e10 + G.ksq*(-1.11476736e10 + G.ksq*(7.6640256e8 + G.ksq*(4.612608e7 + G.ksq*(7.41312e6 + 17.*G.ksq*(6.806904e6 + 19.*G.ksq*(-1.739829e6 + G.ksq*(2.070495e6 + 11.*G.ksq*(-380813. + 13.*G.ksq*(26531. + 16.*G.ksq*(-747. + 136.*G.ksq))))))))))))));
            else if (q == 12) return 4.8763935975571985e-11*G.ksq*G.ksq*G.ksq*(8.05306368e9 + G.ksq*(-1.660944384e10 + G.ksq*(1.868562432e10 + G.ksq*(-1.271660544e10 + G.ksq*(5.1093504e9 + G.ksq*(-1.05380352e9 + G.ksq*(6.342336e7 + G.ksq*(3.39768e6 + G.ksq*(-8.722428e6 + 19.*G.ksq*(2.764047e6 + G.ksq*(-3.958416e6 + G.ksq*(1.0242262e7 + 11.*G.ksq*(-1.129004e6 + 13.*G.ksq*(58701. + 16.*G.ksq*(-1333. + 204.*G.ksq)))))))))))))));
            else if (q == 14) return -6.095491996946498e-12*G.ksq*G.ksq*G.ksq*(-6.442450944e10 + G.ksq*(1.5703474176e11 + G.ksq*(-2.1592276992e11 + G.ksq*(1.8893242368e11 + G.ksq*(-1.0627448832e11 + G.ksq*(3.653185536e10 + G.ksq*(-6.59602944e9 + G.ksq*(3.5335872e8 + G.ksq*(6.7504008e7 + G.ksq*(-3.22445409e8 + G.ksq*(5.47062516e8 + G.ksq*(-1.730970566e9 + G.ksq*(2.634906092e9 + 11.*G.ksq*(-2.16043395e8 + 416.*G.ksq*(282853. + 12.*G.ksq*(-7201. + 952.*G.ksq))))))))))))))));
            else if (q == 16) return 1.2190983993892996e-11*G.ksq*G.ksq*G.ksq*(3.221225472e10 + G.ksq*(-9.05969664e10 + G.ksq*(1.472200704e11 + G.ksq*(-1.574436864e11 + G.ksq*(1.138655232e11 + G.ksq*(-5.479778304e10 + G.ksq*(1.64900736e10 + G.ksq*(-2.6501904e9 + G.ksq*(1.0997844e8 + G.ksq*(1.35102825e8 + G.ksq*(-2.494206e8 + G.ksq*(9.41558566e8 + G.ksq*(-1.726276084e9 + G.ksq*(1.948373145e9 + 44.*G.ksq*(-3.2152275e7 + 208.*G.ksq*(70775. + 4.*G.ksq*(-4671. + 544.*G.ksq)))))))))))))))));
            else if (q == 18) return 2.650213911715869e-13*G.ksq*G.ksq*G.ksq*(1.48176371712e12 + G.ksq*(-4.72312184832e12 + G.ksq*(8.8558534656e12 + G.ksq*(-1.11928147968e13 + G.ksq*(9.8936487936e12 + G.ksq*(-6.12169519104e12 + G.ksq*(2.57904751104e12 + G.ksq*(-6.908162976e11 + G.ksq*(9.947739516e10 + G.ksq*(4.59349605e8 + G.ksq*(-1.0777048425e10 + G.ksq*(4.6367096386e10 + G.ksq*(-9.960494089e10 + G.ksq*(1.35051546489e11 + G.ksq*(-1.22596450725e11 - 176.*G.ksq*(-4.25059925e8 + 104.*G.ksq*(1.617057e6 + 32.*G.ksq*(-11755. + 1224.*G.ksq))))))))))))))))));
        } else if (p == 4){
            if (q == 0) return 5.4859427972518486e-11*G.ksq*G.ksq*G.ksq*G.ksq*(2.68435456e9 + G.ksq*(6.7108864e8 + G.ksq*(2.9360128e8 + G.ksq*(1.572864e8 + 11.*G.ksq*(8.6016e6 + 13.*G.ksq*(430080. + 11.*G.ksq*(26880. + 221.*G.ksq*(-4376. + 19.*G.ksq*(253. + 17.*G.ksq)))))))));
            else if (q == 2) return -6.095491996946498e-12*G.ksq*G.ksq*G.ksq*G.ksq*(-2.415919104e10 + G.ksq*(6.03979776e9 + G.ksq*(8.8080384e8 + G.ksq*(2.8311552e8 + 11.*G.ksq*(1.10592e7 + 13.*G.ksq*(430080. + G.ksq*(241920. + 187.*G.ksq*(58808. + 247.*G.ksq*(-365. + G.ksq*(9. + 68.*G.ksq))))))))));
            else if (q == 4) return 1.8286475990839495e-11*G.ksq*G.ksq*G.ksq*G.ksq*(8.05306368e9 + G.ksq*(-6.03979776e9 + G.ksq*(8.8080384e8 + G.ksq*(9.437184e7 + G.ksq*(2.433024e7 + 13.*G.ksq*(675840. + G.ksq*(295680. + 17.*G.ksq*(-629608. + 209.*G.ksq*(6321. + 13.*G.ksq*(-58. + G.ksq*(-203. + 136.*G.ksq)))))))))));
            else if (q == 6) return -1.8286475990839495e-11*G.ksq*G.ksq*G.ksq*G.ksq*(-8.05306368e9 + G.ksq*(1.00663296e10 + G.ksq*(-4.4040192e9 + G.ksq*(4.718592e8 + G.ksq*(4.05504e7 + G.ksq*(8.78592e6 + G.ksq*(2.7456e6 + 17.*G.ksq*(3.25364e6 + 19.*G.ksq*(-428935. + 11.*G.ksq*(9150. + 13.*G.ksq*(2135. + 4.*G.ksq*(-763. + 272.*G.ksq))))))))))));
            else if (q == 8) return 6.095491996946498e-12*G.ksq*G.ksq*G.ksq*G.ksq*(2.415919104e10 + G.ksq*(-4.227858432e10 + G.ksq*(3.08281344e10 + G.ksq*(-9.9090432e9 + G.ksq*(8.515584e8 + G.ksq*(6.150144e7 + G.ksq*(1.153152e7 + 17.*G.ksq*(-4.280536e6 + 19.*G.ksq*(723541. + G.ksq*(-248745. + 11.*G.ksq*(-68215. + 13.*G.ksq*(12071. + 16.*G.ksq*(-543. + 136.*G.ksq)))))))))))));
            else if (q == 10) return -1.8286475990839495e-11*G.ksq*G.ksq*G.ksq*G.ksq*(-8.05306368e9 + G.ksq*(1.811939328e10 + G.ksq*(-1.849688064e10 + G.ksq*(9.9090432e9 + G.ksq*(-2.5546752e9 + G.ksq*(1.8450432e8 + G.ksq*(1.153152e7 + G.ksq*(1.5312648e7 + 19.*G.ksq*(-2.488239e6 + G.ksq*(1.177029e6 + G.ksq*(3.575355e6 + 11.*G.ksq*(-1.056227e6 + 104.*G.ksq*(11101. + 64.*G.ksq*(-87. + 17.*G.ksq))))))))))))));
            else if (q == 12) return 1.8286475990839495e-11*G.ksq*G.ksq*G.ksq*G.ksq*(8.05306368e9 + G.ksq*(-2.214592512e10 + G.ksq*(2.906652672e10 + G.ksq*(-2.179989504e10 + G.ksq*(9.3671424e9 + G.ksq*(-2.02954752e9 + G.ksq*(1.2684672e8 + G.ksq*(-758472. + G.ksq*(3.2563245e7 + G.ksq*(-1.8205572e7 + G.ksq*(-5.8048914e7 + G.ksq*(2.49070468e8 + 11.*G.ksq*(-3.3350073e7 + 416.*G.ksq*(60515. + 4.*G.ksq*(-5909. + 952.*G.ksq)))))))))))))));
            else if (q == 14) return -6.095491996946498e-12*G.ksq*G.ksq*G.ksq*G.ksq*(-2.415919104e10 + G.ksq*(7.851737088e10 + G.ksq*(-1.2595494912e11 + G.ksq*(1.2145655808e11 + G.ksq*(-7.306371072e10 + G.ksq*(2.638411776e10 + G.ksq*(-4.94702208e9 + G.ksq*(2.87460888e8 + G.ksq*(-5.2239759e7 + G.ksq*(4.8221316e7 + G.ksq*(1.52146566e8 + G.ksq*(-8.17646076e8 + G.ksq*(1.520268945e9 + 88.*G.ksq*(-1.7443919e7 + 832.*G.ksq*(12293. + G.ksq*(-3957. + 544.*G.ksq))))))))))))))));
            else if (q == 16) return 7.950641735147607e-13*G.ksq*G.ksq*G.ksq*G.ksq*(1.8522046464e11 + G.ksq*(-6.945767424e11 + G.ksq*(1.3168017408e12 + G.ksq*(-1.5519449088e12 + G.ksq*(1.2003323904e12 + G.ksq*(-6.0683470848e11 + G.ksq*(1.896358464e11 + G.ksq*(-3.147279564e10 + G.ksq*(1.918460115e9 + G.ksq*(-2.32099725e8 + G.ksq*(-1.01846745e9 + G.ksq*(6.732080342e9 + G.ksq*(-1.5142127273e10 + G.ksq*(1.9173415375e10 + 176.*G.ksq*(-8.5255375e7 + 104.*G.ksq*(395775. + 32.*G.ksq*(-3397. + 408.*G.ksq)))))))))))))))));
            else if (q == 18) return -1.5901283470295214e-13*G.ksq*G.ksq*G.ksq*G.ksq*(-9.261023232e11 + G.ksq*(3.9359348736e12 + G.ksq*(-8.609857536e12 + G.ksq*(1.1992301568e13 + G.ksq*(-1.1336472576e13 + G.ksq*(7.3687071744e12 + G.ksq*(-3.2238093888e12 + G.ksq*(8.89932642456e11 + G.ksq*(-1.33425748599e11 + G.ksq*(7.220033535e9 + G.ksq*(4.82905995e9 + G.ksq*(-3.562528177e10 + G.ksq*(9.4293294069e10 + G.ksq*(-1.43683154301e11 + 4.*G.ksq*(3.5181429705e10 + 176.*G.ksq*(-1.28706575e8 + 416.*G.ksq*(127415. + 48.*G.ksq*(-637. + 68.*G.ksq))))))))))))))))));
        } else if (p == 6){
            if (q == 0) return 1.2190983993892996e-11*pow(G.ksq,5)*(6.03979776e9 + G.ksq*(1.76160768e9 + G.ksq*(8.4934656e8 + 11.*G.ksq*(4.42368e7 + 13.*G.ksq*(2.1504e6 + G.ksq*(1.45152e6 + 187.*G.ksq*(-226592. + 247.*G.ksq*(956. + G.ksq*(81. + 34.*G.ksq)))))))));
            else if (q == 2) return -6.095491996946498e-12*pow(G.ksq,5)*(-1.207959552e10 + G.ksq*(3.52321536e9 + G.ksq*(5.6623104e8 + G.ksq*(1.9464192e8 + 13.*G.ksq*(6.7584e6 + G.ksq*(3.54816e6 + 17.*G.ksq*(5.226944e6 + 209.*G.ksq*(-33232. + 13.*G.ksq*(-75. + G.ksq*(139. + 408.*G.ksq))))))))));
            else if (q == 4) return 7.314590396335798e-11*pow(G.ksq,5)*(1.00663296e9 + G.ksq*(-8.8080384e8 + G.ksq*(1.4155776e8 + G.ksq*(1.622016e7 + G.ksq*(4.39296e6 + G.ksq*(1.64736e6 + 17.*G.ksq*(-1.232816e6 + 19.*G.ksq*(118742. + 11.*G.ksq*(-163. + 13.*G.ksq*(-126. + G.ksq*(-321. + 272.*G.ksq)))))))))));
            else if (q == 6) return -6.095491996946498e-12*pow(G.ksq,5)*(-1.207959552e10 + G.ksq*(1.76160768e10 + G.ksq*(-8.4934656e9 + G.ksq*(9.732096e8 + G.ksq*(8.78592e7 + G.ksq*(1.976832e7 + 17.*G.ksq*(5.480384e6 + 19.*G.ksq*(-563264. + G.ksq*(53205. + 11.*G.ksq*(15050. + 13.*G.ksq*(2915. + 16.*G.ksq*(-339. + 136.*G.ksq))))))))))));
            else if (q == 8) return 1.2190983993892996e-11*pow(G.ksq,5)*(6.03979776e9 + G.ksq*(-1.233125376e10 + G.ksq*(9.9090432e9 + G.ksq*(-3.4062336e9 + G.ksq*(3.075072e8 + G.ksq*(2.306304e7 + G.ksq*(-1.3415584e7 + 19.*G.ksq*(2.41774e6 + G.ksq*(-348789. + G.ksq*(-1.01507e6 + 11.*G.ksq*(-250495. + 52.*G.ksq*(14841. + 16.*G.ksq*(-755. + 204.*G.ksq)))))))))))));
            else if (q == 10) return -1.8286475990839495e-11*pow(G.ksq,5)*(-4.02653184e9 + G.ksq*(1.056964608e10 + G.ksq*(-1.189085184e10 + G.ksq*(6.8124672e9 + G.ksq*(-1.8450432e9 + G.ksq*(1.3837824e8 + G.ksq*(1.4554176e7 + G.ksq*(-1.4713296e7 + G.ksq*(4.157979e6 + G.ksq*(9.882831e6 + G.ksq*(2.8319025e7 + 11.*G.ksq*(-1.1414497e7 + 416.*G.ksq*(34067. + 4.*G.ksq*(-4617. + 952.*G.ksq))))))))))))));
            else if (q == 12) return 4.8763935975571985e-11*pow(G.ksq,5)*(1.50994944e9 + G.ksq*(-4.84442112e9 + G.ksq*(7.00710912e9 + G.ksq*(-5.62028544e9 + G.ksq*(2.5369344e9 + G.ksq*(-5.7081024e8 + G.ksq*(3.5648184e7 + G.ksq*(5.681247e6 + G.ksq*(-799425. + G.ksq*(-2.750022e6 + G.ksq*(-8.804334e6 + G.ksq*(5.2464567e7 + 11.*G.ksq*(-8.003579e6 + 208.*G.ksq*(31445. + 4.*G.ksq*(-3243. + 544.*G.ksq)))))))))))))));
            else if (q == 14) return -2.650213911715869e-13*pow(G.ksq,5)*(-2.7783069696e11 + G.ksq*(1.05344139264e12 + G.ksq*(-1.86233389056e12 + G.ksq*(1.92053182464e12 + G.ksq*(-1.21366941696e12 + G.ksq*(4.5512603136e11 + G.ksq*(-8.7806786496e10 + G.ksq*(4.553865888e9 + G.ksq*(4.12791093e8 + G.ksq*(4.43968668e8 + G.ksq*(1.390381278e9 + G.ksq*(-1.0460196084e10 + G.ksq*(2.2213754069e10 + 176.*G.ksq*(-1.38146701e8 + 104.*G.ksq*(823281. + 32.*G.ksq*(-8627. + 1224.*G.ksq))))))))))))))));
            else if (q == 16) return 3.180256694059043e-13*pow(G.ksq,5)*(2.315255808e11 + G.ksq*(-1.012924416e12 + G.ksq*(2.116288512e12 + G.ksq*(-2.667405312e12 + G.ksq*(2.167266816e12 + G.ksq*(-1.1378150784e12 + G.ksq*(3.66284332128e11 + G.ksq*(-6.1916724012e10 + G.ksq*(3.029767455e9 + G.ksq*(-1.3163865e8 + G.ksq*(-9.8244003e8 + G.ksq*(9.291328852e9 + G.ksq*(-2.3908038713e10 + 2.*G.ksq*(1.6425247205e10 + 176.*G.ksq*(-7.7255825e7 + 416.*G.ksq*(93445. + 192.*G.ksq*(-138. + 17.*G.ksq)))))))))))))))));
            else if (q == 18) return -1.7668092744772458e-14*pow(G.ksq,5)*(-4.1674604544e12 + G.ksq*(2.06636580864e13 + G.ksq*(-4.9814175744e13 + G.ksq*(7.4202365952e13 + G.ksq*(-7.3687071744e13 + G.ksq*(4.97387734272e13 + G.ksq*(-2.2419475633984e13 + G.ksq*(6.33616637368e12 + G.ksq*(-9.58436484291e11 + G.ksq*(4.7862658415e10 + G.ksq*(1.769084889e10 + G.ksq*(-1.75811516946e11 + G.ksq*(5.33414989185e11 + G.ksq*(-8.82735299229e11 + 88.*G.ksq*(1.0398269385e10 + 32.*G.ksq*(-2.18143745e8 + 832.*G.ksq*(111503. - 27450.*G.ksq + 2992.*G.ksq*G.ksq)))))))))))))))));
        } else if (p == 8){
            if (q == 0) return 6.095491996946498e-12*pow(G.ksq,6)*(7.04643072e9 + G.ksq*(2.26492416e9 + G.ksq*(1.16785152e9 + 13.*G.ksq*(5.40672e7 + G.ksq*(3.54816e7 + 17.*G.ksq*(-4.960832e7 + 209.*G.ksq*(240184. + 13.*G.ksq*(1707. + G.ksq*(887. + 408.*G.ksq)))))))));
            else if (q == 2) return -6.095491996946498e-12*pow(G.ksq,6)*(-7.04643072e9 + G.ksq*(2.26492416e9 + G.ksq*(3.8928384e8 + G.ksq*(1.4057472e8 + G.ksq*(6.58944e7 + 17.*G.ksq*(5.315648e7 + 19.*G.ksq*(-3.327272e6 + 11.*G.ksq*(-14631. + 13.*G.ksq*(295. + 12.*G.ksq*(121. + 272.*G.ksq))))))))));
            else if (q == 4) return 6.095491996946498e-12*pow(G.ksq,6)*(7.04643072e9 + G.ksq*(-6.79477248e9 + G.ksq*(1.16785152e9 + G.ksq*(1.4057472e8 + G.ksq*(3.953664e7 + 17.*G.ksq*(-9.313408e6 + 19.*G.ksq*(861640. + G.ksq*(31689. + 11.*G.ksq*(-4606. + 13.*G.ksq*(-937. + 16.*G.ksq*(-135. + 136.*G.ksq)))))))))));
            else if (q == 6) return -6.095491996946498e-12*pow(G.ksq,6)*(-7.04643072e9 + G.ksq*(1.13246208e10 + G.ksq*(-5.8392576e9 + G.ksq*(7.028736e8 + G.ksq*(6.58944e7 + G.ksq*(6.633536e7 + 19.*G.ksq*(-4.740008e6 + G.ksq*(206907. + G.ksq*(784210. + 11.*G.ksq*(143225. + 104.*G.ksq*(3315. + 32.*G.ksq*(-233. + 102.*G.ksq))))))))))));
            else if (q == 8) return 4.266844397862549e-11*pow(G.ksq,6)*(1.00663296e9 + G.ksq*(-2.26492416e9 + G.ksq*(1.9464192e9 + G.ksq*(-7.028736e8 + G.ksq*(6.58944e7 + G.ksq*(2.40448e6 + G.ksq*(6.819176e6 + G.ksq*(-111435. + G.ksq*(-1.274881e6 + G.ksq*(-2.821405e6 + 11.*G.ksq*(-702525. + 416.*G.ksq*(6403. + 12.*G.ksq*(-475. + 136.*G.ksq)))))))))))));
            else if (q == 10) return -6.095491996946498e-12*pow(G.ksq,6)*(-7.04643072e9 + G.ksq*(2.038431744e10 + G.ksq*(-2.452488192e10 + G.ksq*(1.47603456e10 + G.ksq*(-4.1513472e9 + G.ksq*(3.28848e8 + G.ksq*(1.310088e6 + G.ksq*(6.078537e6 + G.ksq*(7.648317e6 + G.ksq*(1.4522403e7 + G.ksq*(4.3038135e7 + 88.*G.ksq*(-2.689127e6 + 416.*G.ksq*(8797. + 2.*G.ksq*(-2529. + 544.*G.ksq))))))))))))));
            else if (q == 12) return 2.650213911715869e-13*pow(G.ksq,6)*(1.6206790656e11 + G.ksq*(-5.7302581248e11 + G.ksq*(8.8639930368e11 + G.ksq*(-7.4687348736e11 + G.ksq*(3.500969472e11 + G.ksq*(-8.124752064e10 + G.ksq*(5.599215336e9 + G.ksq*(2.65696893e8 + G.ksq*(-6.203538e7 + G.ksq*(-2.29616178e8 + G.ksq*(-8.06715756e8 + G.ksq*(6.014510173e9 + 176.*G.ksq*(-6.2930261e7 + 104.*G.ksq*(524925. + 32.*G.ksq*(-7063. + 1224.*G.ksq)))))))))))))));
            else if (q == 14) return -5.3004278234317375e-14*pow(G.ksq,6)*(-8.103395328e11 + G.ksq*(3.3860616192e12 + G.ksq*(-6.4017727488e12 + G.ksq*(6.9352538112e12 + G.ksq*(-4.5512603136e12 + G.ksq*(1.758672060288e12 + G.ksq*(-3.48731014632e11 + G.ksq*(2.0242560195e10 + G.ksq*(1.43001144e9 + G.ksq*(1.05726621e9 + G.ksq*(3.446992692e9 + G.ksq*(-3.2379461933e10 + 4.*G.ksq*(1.8883467395e10 + 176.*G.ksq*(-1.24740945e8 + 416.*G.ksq*(194065. + 144.*G.ksq*(-467. + 68.*G.ksq))))))))))))))));
            else if (q == 16) return 1.7668092744772458e-14*pow(G.ksq,6)*(2.4310185984e12 + G.ksq*(-1.1720982528e13 + G.ksq*(2.6189070336e13 + G.ksq*(-3.4676269056e13 + G.ksq*(2.9258102016e13 + G.ksq*(-1.582635765568e13 + G.ksq*(5.221665341464e12 + G.ksq*(-9.03900670101e11 + G.ksq*(4.5493162715e10 + G.ksq*(6.92835e6 + G.ksq*(-8.56759761e9 + G.ksq*(1.03070292351e11 + G.ksq*(-2.91426399849e11 + 88.*G.ksq*(4.835849985e9 + 32.*G.ksq*(-1.30679225e8 + 832.*G.ksq*(81695. - 23778.*G.ksq + 2992.*G.ksq*G.ksq))))))))))))))));
            else if (q == 18) return -6.092445774059469e-16*pow(G.ksq,6)*(-7.04995393536e13 + G.ksq*(3.852296257536e14 + G.ksq*(-9.93170128896e14 + G.ksq*(1.554127331328e15 + G.ksq*(-1.602693810432e15 + G.ksq*(1.11460722840896e15 + G.ksq*(-5.14752720389336e14 + G.ksq*(1.48487786812365e14 + G.ksq*(-2.2848750547909e13 + G.ksq*(1.10830459311e12 + G.ksq*(2.6960288355e11 + G.ksq*(-3.128524747959e12 + G.ksq*(1.0440348691695e13 + 44.*G.ksq*(-4.17450624309e11 + 32.*G.ksq*(1.4130427115e10 + 32.*G.ksq*(-3.06502945e8 + 104.*G.ksq*(1.286781e6 + 44.*G.ksq*(-7355. + 816.*G.ksq))))))))))))))))));
        } else if (p == 10){
            if (q == 0) return 3.657295198167899e-11*pow(G.ksq,7)*(7.5497472e8 + G.ksq*(2.5952256e8 + G.ksq*(1.4057472e8 + G.ksq*(8.78592e7 + 17.*G.ksq*(-9.862528e7 + 19.*G.ksq*(5.16984e6 + 11.*G.ksq*(45642. + 13.*G.ksq*(1971. + 2.*G.ksq*(563. + 272.*G.ksq)))))))));
            else if (q == 2) return -6.095491996946498e-12*pow(G.ksq,7)*(-4.52984832e9 + G.ksq*(1.55713536e9 + G.ksq*(2.8114944e8 + G.ksq*(1.0543104e8 + 17.*G.ksq*(4.3843072e7 + 19.*G.ksq*(-2.465632e6 + G.ksq*(-129252. + 11.*G.ksq*(-771. + 13.*G.ksq*(515. + 16.*G.ksq*(69. + 136.*G.ksq))))))))));
            else if (q == 4) return 7.314590396335798e-11*pow(G.ksq,7)*(3.7748736e8 + G.ksq*(-3.8928384e8 + G.ksq*(7.028736e7 + G.ksq*(8.78592e6 + G.ksq*(-7.666048e6 + 19.*G.ksq*(825656. + G.ksq*(62135. + G.ksq*(-6426. + 11.*G.ksq*(-5321. + 26.*G.ksq*(-425. + 16.*G.ksq*(-59. + 68.*G.ksq)))))))))));
            else if (q == 6) return -1.8286475990839495e-11*pow(G.ksq,7)*(-1.50994944e9 + G.ksq*(2.5952256e9 + G.ksq*(-1.4057472e9 + G.ksq*(1.757184e8 + G.ksq*(2.772224e7 + G.ksq*(-1.410864e7 + G.ksq*(1.050396e6 + G.ksq*(1.991941e6 + G.ksq*(3.39473e6 + 11.*G.ksq*(544255. + 416.*G.ksq*(3135. + 4.*G.ksq*(-2033. + 952.*G.ksq))))))))))));
            else if (q == 8) return 1.2190983993892996e-11*pow(G.ksq,7)*(2.26492416e9 + G.ksq*(-5.44997376e9 + G.ksq*(4.9201152e9 + G.ksq*(-1.8450432e9 + G.ksq*(1.7283968e8 + G.ksq*(2.452216e7 + G.ksq*(2.649246e6 + G.ksq*(-637925. + G.ksq*(-2.613716e6 + G.ksq*(-5.528145e6 + 44.*G.ksq*(-358435. + 208.*G.ksq*(7619. + 4.*G.ksq*(-1815. + 544.*G.ksq)))))))))))));
            else if (q == 10) return -2.385192520544282e-12*pow(G.ksq,7)*(-1.157627904e10 + G.ksq*(3.581411328e10 + G.ksq*(-4.526505984e10 + G.ksq*(2.82906624e10 + G.ksq*(-8.18711296e9 + G.ksq*(6.2548304e8 + G.ksq*(4.5055916e7 + G.ksq*(1.2652879e7 + G.ksq*(1.1599899e7 + G.ksq*(2.0351261e7 + G.ksq*(6.3524125e7 + 176.*G.ksq*(-2.316157e6 + 104.*G.ksq*(32473. + 32.*G.ksq*(-611. + 136.*G.ksq))))))))))))));
            else if (q == 12) return 1.9081540164354257e-12*pow(G.ksq,7)*(1.44703488e10 + G.ksq*(-5.47160064e10 + G.ksq*(8.89135104e10 + G.ksq*(-7.77993216e10 + G.ksq*(3.7567623808e10 + G.ksq*(-8.909303832e9 + G.ksq*(5.99195685e8 + G.ksq*(3.1106515e7 + G.ksq*(-2.52263e6 + G.ksq*(-1.6294058e7 + G.ksq*(-6.4080863e7 + G.ksq*(5.59867775e8 + 176.*G.ksq*(-6.277855e6 + 416.*G.ksq*(13715. + 32.*G.ksq*(-191. + 34.*G.ksq)))))))))))))));
            else if (q == 14) return -1.7668092744772458e-14*pow(G.ksq,7)*(-1.5627976704e12 + G.ksq*(6.9837520896e12 + G.ksq*(-1.38705076224e13 + G.ksq*(1.56043210752e13 + G.ksq*(-1.0550341474816e13 + G.ksq*(4.175472297568e12 + G.ksq*(-8.43172989516e11 + G.ksq*(4.9783197035e10 + G.ksq*(3.17872698e9 + G.ksq*(1.773380466e9 + G.ksq*(5.931906552e9 + G.ksq*(-6.4824791109e10 + 88.*G.ksq*(1.842067305e9 + 32.*G.ksq*(-7.0130945e7 + 832.*G.ksq*(56477. - 20106.*G.ksq + 2992.*G.ksq*G.ksq)))))))))))))));
            else if (q == 16) return 3.655467464435681e-15*pow(G.ksq,7)*(7.5535220736e12 + G.ksq*(-3.8947848192e13 + G.ksq*(9.1419254784e13 + G.ksq*(-1.25701475328e14 + G.ksq*(1.0927380939904e14 + G.ksq*(-6.055407091448e13 + G.ksq*(2.0379111229906e13 + G.ksq*(-3.588241471529e12 + G.ksq*(1.8475091921e11 + G.ksq*(3.52375881e9 + G.ksq*(-2.324771163e10 + G.ksq*(3.31497182679e11 + 22.*G.ksq*(-4.5657108393e10 + 32.*G.ksq*(2.183677355e9 + 32.*G.ksq*(-6.1102295e7 + 416.*G.ksq*(78500. + 11.*G.ksq*(-2123. + 272.*G.ksq)))))))))))))))));
            else if (q == 18) return -5.895915265218841e-17*pow(G.ksq,7)*(-4.683183685632e14 + G.ksq*(2.7367354662912e15 + G.ksq*(-7.411991887872e15 + G.ksq*(1.2044486817792e16 + G.ksq*(-1.279724111201536e16 + G.ksq*(9.11796961588656e15 + G.ksq*(-4.295986354077132e15 + G.ksq*(1.260353352285885e15 + G.ksq*(-1.96827992928853e14 + G.ksq*(9.48663723293e12 + G.ksq*(1.71903864561e12 + G.ksq*(-2.1446900650383e13 + 11.*G.ksq*(6.976678851285e12 + 32.*G.ksq*(-4.02055399591e11 + 16.*G.ksq*(2.8188361215e10 + 208.*G.ksq*(-9.6669225e7 + 44.*G.ksq*(980577. + 16.*G.ksq*(-15695. + 1768.*G.ksq))))))))))))))))));
        } else if (p == 12){
            if (q == 0) return 6.095491996946498e-12*pow(G.ksq,8)*(3.11427072e9 + G.ksq*(1.12459776e9 + G.ksq*(6.3258624e8 + 17.*G.ksq*(-5.47908608e8 + 19.*G.ksq*(2.8553408e7 + G.ksq*(2.88312e6 + 11.*G.ksq*(152967. + 13.*G.ksq*(7271. + 16.*G.ksq*(273. + 136.*G.ksq)))))))));
            else if (q == 2) return -6.095491996946498e-12*pow(G.ksq,8)*(-3.11427072e9 + G.ksq*(1.12459776e9 + G.ksq*(2.1086208e8 + G.ksq*(6.53339648e8 + 19.*G.ksq*(-3.2007872e7 + G.ksq*(-1.451664e6 + G.ksq*(-221289. + 11.*G.ksq*(49963. + 104.*G.ksq*(1071. + 64.*G.ksq*(28. + 51.*G.ksq))))))))));
            else if (q == 4) return 1.8286475990839495e-11*pow(G.ksq,8)*(1.03809024e9 + G.ksq*(-1.12459776e9 + G.ksq*(2.1086208e8 + G.ksq*(-2.941952e6 + G.ksq*(4.8641216e7 + G.ksq*(5.772656e6 + G.ksq*(1.503565e6 + G.ksq*(-1.053626e6 + 11.*G.ksq*(-295545. + 416.*G.ksq*(-1349. + 4.*G.ksq*(-741. + 952.*G.ksq)))))))))));
            else if (q == 6) return -6.095491996946498e-12*pow(G.ksq,8)*(-3.11427072e9 + G.ksq*(5.6229888e9 + G.ksq*(-3.1629312e9 + G.ksq*(4.2884608e8 + G.ksq*(6.7184e6 + G.ksq*(8.44968e6 + G.ksq*(4.699973e6 + G.ksq*(4.956758e6 + G.ksq*(6.904125e6 + 88.*G.ksq*(130625. + 832.*G.ksq*(380. + G.ksq*(-1101. + 544.*G.ksq))))))))))));
            else if (q == 8) return 2.650213911715869e-13*pow(G.ksq,8)*(7.162822656e10 + G.ksq*(-1.8106023936e11 + G.ksq*(1.697439744e11 + G.ksq*(-6.573339136e10 + G.ksq*(6.75736672e9 + G.ksq*(5.2736856e8 + G.ksq*(8.4531361e7 + G.ksq*(-1.5831845e7 + G.ksq*(-7.1133321e7 + G.ksq*(-1.53755315e8 + 176.*G.ksq*(-2.620765e6 + 104.*G.ksq*(125277. + 32.*G.ksq*(-3935. + 1224.*G.ksq)))))))))))));
            else if (q == 10) return -4.770385041088564e-13*pow(G.ksq,8)*(-3.97934592e10 + G.ksq*(1.293287424e11 + G.ksq*(-1.697439744e11 + G.ksq*(1.09334930432e11 + G.ksq*(-3.2509800128e10 + G.ksq*(2.62206232e9 + G.ksq*(1.87690455e8 + G.ksq*(4.7908975e7 + G.ksq*(3.6580073e7 + G.ksq*(6.1297173e7 + 4.*G.ksq*(5.0313235e7 + 176.*G.ksq*(-2.056365e6 + 416.*G.ksq*(7605. + 16.*G.ksq*(-297. + 68.*G.ksq))))))))))))));
            else if (q == 12) return 1.9434902019249706e-13*pow(G.ksq,8)*(9.76748544e10 + G.ksq*(-3.879862272e11 + G.ksq*(6.547267584e11 + G.ksq*(-5.90276191232e11 + G.ksq*(2.92115225792e11 + G.ksq*(-7.0769077776e10 + G.ksq*(4.831154605e9 + G.ksq*(2.6420754e8 + G.ksq*(1.238382e6 + G.ksq*(-8.9893332e7 + G.ksq*(-3.96279219e8 + 8.*G.ksq*(4.86050625e8 + 352.*G.ksq*(-2.874475e6 + 832.*G.ksq*(3259. + 2.*G.ksq*(-747. + 136.*G.ksq)))))))))))))));
            else if (q == 14) return -6.701690351465416e-15*pow(G.ksq,8)*(-2.8325707776e12 + G.ksq*(1.32973461504e13 + G.ksq*(-2.74257764352e13 + G.ksq*(3.1789359420416e13 + G.ksq*(-2.2021429896128e13 + G.ksq*(8.892968243952e12 + G.ksq*(-1.825976010469e12 + G.ksq*(1.0915350888e11 + G.ksq*(6.597326034e9 + G.ksq*(2.958092748e9 + G.ksq*(9.914923083e9 + 4.*G.ksq*(-3.0131421489e10 + 32.*G.ksq*(2.483437255e9 + 352.*G.ksq*(-8.921779e6 + 104.*G.ksq*(59133. + 4.*G.ksq*(-5383. + 816.*G.ksq))))))))))))))));
            else if (q == 16) return 6.485506791740725e-16*pow(G.ksq,8)*(2.92698980352e13 + G.ksq*(-1.58545281024e14 + G.ksq*(3.86454122496e14 + G.ksq*(-5.4747862993408e14 + G.ksq*(4.876015653808e14 + G.ksq*(-2.7568013252936e14 + G.ksq*(9.4352943731917e13 + G.ksq*(-1.6852130539803e13 + G.ksq*(8.8228275265e11 + G.ksq*(2.524368405e10 + G.ksq*(-8.1279574935e10 + G.ksq*(1.315197410553e12 + 32.*G.ksq*(-1.31279407571e11 + 16.*G.ksq*(1.3034992055e10 + 2288.*G.ksq*(-5.248475e6 + 4.*G.ksq*(717325. + 16.*G.ksq*(-13587. + 1768.*G.ksq)))))))))))))))));
            else if (q == 18) return -1.96530508840628e-17*pow(G.ksq,8)*(-9.659066351616e14 + G.ksq*(5.9295935102976e15 + G.ksq*(-1.6676981747712e16 + G.ksq*(2.792134360910336e16 + G.ksq*(-3.039360443236832e16 + G.ksq*(2.209375848035928e16 + G.ksq*(-1.058654865051884e16 + G.ksq*(3.150839614905125e15 + G.ksq*(-4.98313018900554e14 + G.ksq*(2.405630139913e13 + G.ksq*(3.529934048355e12 + G.ksq*(-4.5187009403679e13 + 16.*G.ksq*(1.0657363816385e13 + 64.*G.ksq*(-3.18746161349e11 + 26.*G.ksq*(1.4150221575e10 + 352.*G.ksq*(-2.9333925e7 + 4.*G.ksq*(3.334567e6 + 416.*G.ksq*(-2085. + 238.*G.ksq))))))))))))))))));
        } else if (p == 14){
            if (q == 0) return 1.2190983993892996e-11*pow(G.ksq,9)*(1.12459776e9 + G.ksq*(4.2172416e8 + G.ksq*(-4.330553344e9 + 19.*G.ksq*(2.26700032e8 + G.ksq*(2.3780688e7 + G.ksq*(1.419177e7 + 11.*G.ksq*(828427. + 52.*G.ksq*(10353. + 16.*G.ksq*(401. + 204.*G.ksq)))))))));
            else if (q == 2) return -6.095491996946498e-12*pow(G.ksq,9)*(-2.24919552e9 + G.ksq*(8.4344832e8 + G.ksq*(6.44513792e8 + G.ksq*(-4.6222592e8 + G.ksq*(-1.0263648e7 + G.ksq*(306204. + G.ksq*(7.281389e6 + 11.*G.ksq*(1.229661e6 + 416.*G.ksq*(4465. + 12.*G.ksq*(551. + 952.*G.ksq))))))))));
            else if (q == 4) return 2.4381967987785993e-11*pow(G.ksq,9)*(5.6229888e8 + G.ksq*(-6.3258624e8 + G.ksq*(1.05005056e8 + G.ksq*(3.8160512e7 + G.ksq*(6.441912e6 + G.ksq*(2.302667e6 + G.ksq*(448970. + G.ksq*(-712215. + 22.*G.ksq*(-79819. + 208.*G.ksq*(-703. + 4.*G.ksq*(-387. + 544.*G.ksq)))))))))));
            else if (q == 6) return -2.650213911715869e-13*pow(G.ksq,9)*(-5.173149696e10 + G.ksq*(9.69965568e10 + G.ksq*(-5.586993152e10 + G.ksq*(6.91188992e9 + G.ksq*(7.217112e8 + G.ksq*(1.9263074e8 + G.ksq*(9.8173589e7 + G.ksq*(8.7661554e7 + G.ksq*(1.10629685e8 + 176.*G.ksq*(1.015075e6 + 104.*G.ksq*(23985. + 32.*G.ksq*(-2371. + 1224.*G.ksq))))))))))));
            else if (q == 8) return 1.0600855646863475e-13*pow(G.ksq,9)*(1.293287424e11 + G.ksq*(-3.394879488e11 + G.ksq*(3.27673708544e11 + G.ksq*(-1.29400683776e11 + G.ksq*(1.311770184e10 + G.ksq*(1.05593545e9 + G.ksq*(1.76010775e8 + G.ksq*(-1.3222974e7 + G.ksq*(-1.08551009e8 + 2.*G.ksq*(-1.23749185e8 + 176.*G.ksq*(-2.221275e6 + 416.*G.ksq*(29095. + 576.*G.ksq*(-53. + 17.*G.ksq)))))))))))));
            else if (q == 10) return -1.7668092744772458e-14*pow(G.ksq,9)*(-7.759724544e11 + G.ksq*(2.6189070336e12 + G.ksq*(-3.540994981888e12 + G.ksq*(2.335502880256e12 + G.ksq*(-7.07664172896e11 + G.ksq*(5.821034294e10 + G.ksq*(4.199825265e9 + G.ksq*(1.001284173e9 + G.ksq*(6.66197019e8 + G.ksq*(1.074757971e9 + 88.*G.ksq*(4.1875785e7 + 32.*G.ksq*(-1.0264385e7 + 832.*G.ksq*(19811. + 2.*G.ksq*(-6381. + 1496.*G.ksq))))))))))))));
            else if (q == 12) return 2.6806761405861663e-14*pow(G.ksq,9)*(5.114363904e11 + G.ksq*(-2.1096751104e12 + G.ksq*(3.667837468672e12 + G.ksq*(-3.38752208704e12 + G.ksq*(1.710166247112e12 + G.ksq*(-4.21468131731e11 + G.ksq*(2.9203881885e10 + G.ksq*(1.658309778e9 + G.ksq*(8.779653e7 + G.ksq*(-3.94293567e8 + G.ksq*(-1.940485239e9 + 32.*G.ksq*(6.49522205e8 + 352.*G.ksq*(-4.007207e6 + 208.*G.ksq*(18735. + 2.*G.ksq*(-4397. + 816.*G.ksq)))))))))))))));
            else if (q == 14) return -2.810386276420981e-15*pow(G.ksq,9)*(-4.8783163392e12 + G.ksq*(2.37817921536e13 + G.ksq*(-5.0535826751488e13 + G.ksq*(6.0010797643264e13 + G.ksq*(-4.2412183232736e13 + G.ksq*(1.7419505759324e13 + G.ksq*(-3.628664064933e12 + G.ksq*(2.19335797308e11 + G.ksq*(1.2879379026e10 + G.ksq*(4.886453136e9 + G.ksq*(1.6099689771e10 + 32.*G.ksq*(-6.607077161e9 + 16.*G.ksq*(1.135874081e9 + 176.*G.ksq*(-8.412933e6 + 52.*G.ksq*(114191. + 48.*G.ksq*(-883. + 136.*G.ksq))))))))))))))));
            else if (q == 16) return 5.109793229856328e-16*pow(G.ksq,9)*(2.68307398656e13 + G.ksq*(-1.50922911744e14 + G.ksq*(3.7902110851072e14 + G.ksq*(-5.5010587595392e14 + G.ksq*(4.998582348804e14 + G.ksq*(-2.8741928874483e14 + G.ksq*(9.9796896426601e13 + G.ksq*(-1.8046064925504e13 + G.ksq*(9.5728242203e11 + G.ksq*(3.260415675e10 + G.ksq*(-6.8672879055e10 + 8.*G.ksq*(1.53301762823e11 + 32.*G.ksq*(-1.5949044991e10 + 4.*G.ksq*(6.529435875e9 + 176.*G.ksq*(-3.4996125e7 + 104.*G.ksq*(187525. + 16.*G.ksq*(-3609. + 476.*G.ksq)))))))))))))))));
            else if (q == 18) return -2.554896614928164e-16*pow(G.ksq,9)*(-5.36614797312e13 + G.ksq*(3.420919332864e14 + G.ksq*(-9.91287955324928e14 + G.ksq*(1.700333173740032e15 + G.ksq*(-1.88835383430672e15 + G.ksq*(1.39603412238906e15 + G.ksq*(-6.78625684181357e14 + G.ksq*(2.04500008596477e14 + G.ksq*(-3.2697909391906e13 + G.ksq*(1.58558178339e12 + G.ksq*(1.99238664735e11 + G.ksq*(-2.549141907983e12 + 128.*G.ksq*(7.8356336641e10 + 4.*G.ksq*(-3.8646506487e10 + 8.*G.ksq*(5.709452805e9 + 88.*G.ksq*(-4.8261725e7 + 416.*G.ksq*(53601. + 4.*G.ksq*(-3533. + 408.*G.ksq))))))))))))))))));
        } else if (p == 16){
            if (q == 0) return 1.8286475990839495e-11*pow(G.ksq,10)*(5.6229888e8 + G.ksq*(-2.672197632e9 + G.ksq*(2.717458432e9 + G.ksq*(2.97800832e8 + G.ksq*(1.79864488e8 + G.ksq*(1.17854625e8 + 11.*G.ksq*(7.229063e6 + 416.*G.ksq*(11647. + 4.*G.ksq*(1843. + 952.*G.ksq)))))))));
            else if (q == 2) return -6.095491996946498e-12*pow(G.ksq,10)*(-1.68689664e9 + G.ksq*(1.064534016e9 + G.ksq*(-3.09583872e8 + G.ksq*(1.5504e7 + G.ksq*(9.516872e6 + G.ksq*(9.077269e6 + G.ksq*(1.0677411e7 + 88.*G.ksq*(152361. + 416.*G.ksq*(475. + 2.*G.ksq*(327. + 544.*G.ksq))))))))));
            else if (q == 4) return 7.950641735147607e-13*pow(G.ksq,10)*(1.293287424e10 + G.ksq*(-1.5403155456e10 + G.ksq*(3.474219008e9 + G.ksq*(4.38122368e8 + G.ksq*(1.34825368e8 + G.ksq*(4.6492943e7 + G.ksq*(7.379258e6 + G.ksq*(-1.6974657e7 + 176.*G.ksq*(-222167. + 104.*G.ksq*(-3873. + 32.*G.ksq*(-269. + 408.*G.ksq)))))))))));
            else if (q == 6) return -1.5901283470295214e-13*pow(G.ksq,10)*(-6.46643712e10 + G.ksq*(1.25332586496e11 + G.ksq*(-7.4747305984e10 + G.ksq*(9.94798656e9 + G.ksq*(1.0250082e9 + G.ksq*(2.80963165e8 + G.ksq*(1.37287274e8 + G.ksq*(1.12015469e8 + 4.*G.ksq*(3.3189105e7 + 176.*G.ksq*(298925. + 416.*G.ksq*(1795. + 48.*G.ksq*(-127. + 68.*G.ksq))))))))))));
            else if (q == 8) return 1.7668092744772458e-14*pow(G.ksq,10)*(5.819793408e11 + G.ksq*(-1.574952730624e12 + G.ksq*(1.5590987776e12 + G.ksq*(-6.28957961856e11 + G.ksq*(6.454595564e10 + G.ksq*(5.255889915e9 + G.ksq*(9.21946329e8 + G.ksq*(1.4890965e7 + G.ksq*(-4.10232249e8 + 88.*G.ksq*(-1.1434815e7 + 32.*G.ksq*(-1.186745e6 + 832.*G.ksq*(8363. - 9090.*G.ksq + 2992.*G.ksq*G.ksq))))))))))));
            else if (q == 10) return -1.8277337322178406e-15*pow(G.ksq,10)*(-5.6258002944e12 + G.ksq*(1.9565331382272e13 + G.ksq*(-2.7107129434112e13 + G.ksq*(1.8241684619648e13 + G.ksq*(-5.618832616968e12 + G.ksq*(4.68921911875e11 + G.ksq*(3.4000957083e10 + G.ksq*(7.727586957e9 + G.ksq*(4.606354737e9 + 44.*G.ksq*(1.62770097e8 + 32.*G.ksq*(1.8062625e7 + 32.*G.ksq*(-4.734763e6 + 104.*G.ksq*(75707. + 44.*G.ksq*(-1137. + 272.*G.ksq))))))))))))));
            else if (q == 12) return 6.485506791740725e-16*pow(G.ksq,10)*(1.58545281024e13 + G.ksq*(-6.7384633884672e13 + G.ksq*(1.20029210189824e14 + G.ksq*(-1.1309925579456e14 + G.ksq*(5.8063842178856e13 + G.ksq*(-1.4517117163463e13 + G.ksq*(1.018998592492e12 + G.ksq*(5.9439565686e10 + G.ksq*(4.87716282e9 + G.ksq*(-1.0441400871e10 + 32.*G.ksq*(-1.783749891e9 + 16.*G.ksq*(1.278234119e9 + 2288.*G.ksq*(-1.255551e6 + 4.*G.ksq*(313085. + 16.*G.ksq*(-9371. + 1768.*G.ksq)))))))))))))));
            else if (q == 14) return -2.554896614928164e-16*pow(G.ksq,10)*(-4.02461097984e13 + G.ksq*(2.02148122755072e14 + G.ksq*(-4.40092977831936e14 + G.ksq*(5.33182454200704e14 + G.ksq*(-3.83224014137096e14 + G.ksq*(1.59678488138939e14 + G.ksq*(-3.367943608062e13 + G.ksq*(2.056238013346e12 + G.ksq*(1.18959297996e11 + G.ksq*(3.9750829371e10 + 16.*G.ksq*(7.946065281e9 + 128.*G.ksq*(-8.63607525e8 + G.ksq*(2.457576303e9 + 704.*G.ksq*(-4.666703e6 + 26.*G.ksq*(129247. + 64.*G.ksq*(-762. + 119.*G.ksq))))))))))))))));
            else if (q == 16) return 7.664689844784493e-16*pow(G.ksq,10)*(1.34153699328e13 + G.ksq*(-7.7748579434496e13 + G.ksq*(2.00040473944064e14 + G.ksq*(-2.9621245484864e14 + G.ksq*(2.737318482998e14 + G.ksq*(-1.59677297109385e14 + G.ksq*(5.6135959581823e13 + G.ksq*(-1.0261114849282e13 + G.ksq*(5.5026336563e11 + G.ksq*(2.0630968875e10 + G.ksq*(-3.2104567605e10 + 128.*G.ksq*(4.853385559e9 + 4.*G.ksq*(-4.176254329e9 + 8.*G.ksq*(8.76597935e8 + 88.*G.ksq*(-9.586375e6 + 416.*G.ksq*(13055. - 4076.*G.ksq + 544.*G.ksq*G.ksq))))))))))))))));
            else if (q == 18) return -2.071537795887701e-17*pow(G.ksq,10)*(-4.963686875136e14 + G.ksq*(3.260246805676032e15 + G.ksq*(-9.67885368406016e15 + G.ksq*(1.6937965658176128e16 + G.ksq*(-1.913082232505708e16 + G.ksq*(1.4348126083901444e16 + G.ksq*(-7.061953784657321e15 + G.ksq*(2.15125030831117e15 + G.ksq*(-3.47282976613034e14 + G.ksq*(1.6931659661785e13 + G.ksq*(1.892697443835e12 + 16.*G.ksq*(-1.490778385349e12 + 128.*G.ksq*(4.7392158255e10 + G.ksq*(-9.5861543797e10 + 64.*G.ksq*(1.805957685e9 + 22.*G.ksq*(-6.2075245e7 + 832.*G.ksq*(34952. + G.ksq*(-9325. + 1088.*G.ksq))))))))))))))))));
        } else if (p == 18){
            if (q == 0) return 1.2190983993892996e-11*pow(G.ksq,11)*(-3.47602944e9 + G.ksq*(3.921395712e9 + G.ksq*(4.54453248e8 + G.ksq*(2.74555168e8 + G.ksq*(1.81320572e8 + G.ksq*(1.24618245e8 + 44.*G.ksq*(1.969293e6 + 208.*G.ksq*(6479. + 4.*G.ksq*(1041. + 544.*G.ksq)))))))));
            else if (q == 2) return -2.650213911715869e-13*pow(G.ksq,11)*(-2.1725184e10 + G.ksq*(3.302227968e9 + G.ksq*(1.670959104e9 + G.ksq*(6.2336416e8 + G.ksq*(3.48256016e8 + G.ksq*(2.67718227e8 + G.ksq*(2.57454693e8 + 176.*G.ksq*(1.605899e6 + 104.*G.ksq*(18465. + 32.*G.ksq*(757. + 1224.*G.ksq))))))))));
            else if (q == 4) return 6.360513388118086e-13*pow(G.ksq,11)*(1.2079202304e10 + G.ksq*(-1.4344052736e10 + G.ksq*(3.0346496e9 + G.ksq*(4.2478376e8 + G.ksq*(1.2835697e8 + G.ksq*(4.3545891e7 + G.ksq*(6.785546e6 + G.ksq*(-1.5687635e7 + 176.*G.ksq*(-204565. + 416.*G.ksq*(-895. + 96.*G.ksq*(-21. + 34.*G.ksq)))))))))));
            else if (q == 6) return -1.7668092744772458e-14*pow(G.ksq,11)*(-4.4695945216e11 + G.ksq*(8.86373023744e11 + G.ksq*(-5.39426082816e11 + G.ksq*(7.377102944e10 + G.ksq*(7.7845584e9 + G.ksq*(2.157531795e9 + G.ksq*(1.023030186e9 + G.ksq*(7.84575531e8 + 88.*G.ksq*(1.0087785e7 + 32.*G.ksq*(493375. + 832.*G.ksq*(1505. - 5418.*G.ksq + 2992.*G.ksq*G.ksq)))))))))));
            else if (q == 8) return 1.2184891548118937e-15*pow(G.ksq,11)*(6.51118247936e12 + G.ksq*(-1.8053761875968e13 + G.ksq*(1.824263648256e13 + G.ksq*(-7.492332568672e12 + G.ksq*(7.7959327158e11 + G.ksq*(6.4369657395e10 + G.ksq*(1.1807299428e10 + G.ksq*(9.61164495e8 + 22.*G.ksq*(-1.74908979e8 + 32.*G.ksq*(-1.4643335e7 + 32.*G.ksq*(-1.592885e6 + 416.*G.ksq*(23829. + 11.*G.ksq*(-2425. + 816.*G.ksq)))))))))))));
            else if (q == 10) return -5.895915265218841e-17*pow(G.ksq,11)*(-1.3470569988096e14 + G.ksq*(4.80000299630592e14 + G.ksq*(-6.78599590531072e14 + G.ksq*(4.64518452841408e14 + G.ksq*(-1.45151709529968e14 + G.ksq*(1.2263014186985e13 + G.ksq*(8.93390418213e11 + G.ksq*(1.96445787867e11 + 11.*G.ksq*(9.742091157e9 + 32.*G.ksq*(4.56015609e8 + 16.*G.ksq*(1.04012895e8 + 208.*G.ksq*(-4.423393e6 + 44.*G.ksq*(172097. + 16.*G.ksq*(-7263. + 1768.*G.ksq))))))))))))));
            else if (q == 12) return 1.572244070725024e-16*pow(G.ksq,11)*(5.052908470272e13 + G.ksq*(-2.20030596943872e14 + G.ksq*(3.99887057923584e14 + G.ksq*(-3.83225673985e14 + G.ksq*(1.99594434926491e14 + G.ksq*(-5.0525714436978e13 + G.ksq*(3.586574980142e12 + G.ksq*(2.13427155876e11 + G.ksq*(2.1524319135e10 + 2.*G.ksq*(-1.4428644153e10 + 32.*G.ksq*(-2.725865373e9 + 52.*G.ksq*(6.34516251e8 + 176.*G.ksq*(-8.335007e6 + 8.*G.ksq*(1.061725e6 + 208.*G.ksq*(-2487. + 476.*G.ksq)))))))))))))));
            else if (q == 14) return -2.554896614928164e-16*pow(G.ksq,11)*(-3.1097615548416e13 + G.ksq*(1.60028444000256e14 + G.ksq*(-3.55454910345216e14 + G.ksq*(4.37971530762304e14 + G.ksq*(-3.19353403189216e14 + G.ksq*(1.34728442664849e14 + G.ksq*(-2.87271065345e13 + G.ksq*(1.769749394886e12 + G.ksq*(1.01643735996e11 + G.ksq*(3.0823341681e10 + 128.*G.ksq*(7.42436277e8 + 4.*G.ksq*(-2.698457775e9 + 8.*G.ksq*(9.87114349e8 + 88.*G.ksq*(-1.5317437e7 + 416.*G.ksq*(26973. + 4.*G.ksq*(-2581. + 408.*G.ksq))))))))))))))));
            else if (q == 16) return 4.143075591775402e-17*pow(G.ksq,11)*(1.9177468329984e14 + G.ksq*(-1.138678074064896e15 + G.ksq*(2.989052414388224e15 + G.ksq*(-4.50137196898224e15 + G.ksq*(4.2200330454271e15 + G.ksq*(-2.492461640064935e15 + G.ksq*(8.85794529443868e14 + G.ksq*(-1.63461616042362e14 + G.ksq*(8.84750275508e12 + G.ksq*(3.52414221225e11 + 8.*G.ksq*(-5.4176259885e10 + 32.*G.ksq*(3.5047222847e10 + 4.*G.ksq*(-3.0993296607e10 + 16.*G.ksq*(3.322176115e9 + 88.*G.ksq*(-3.6957425e7 + 208.*G.ksq*(102105. + 4.*G.ksq*(-8067. + 1088.*G.ksq)))))))))))))))));
            else if (q == 18) return -9.029780135920748e-18*pow(G.ksq,11)*(-8.7991805411328e14 + G.ksq*(5.921152320405504e15 + G.ksq*(-1.79343146609664e16 + G.ksq*(3.1918814424917056e16 + G.ksq*(-3.657363235387576e16 + G.ksq*(2.7773115454885516e16 + G.ksq*(-1.3818466123674928e16 + G.ksq*(4.24976259928363e15 + G.ksq*(-6.91901214207918e14 + G.ksq*(3.3921836729495e13 + G.ksq*(3.464346044445e12 + 32.*G.ksq*(-1.333232888169e12 + 16.*G.ksq*(3.48589042295e11 + 16.*G.ksq*(-4.5002414561e10 + 4.*G.ksq*(1.3798260255e10 + 176.*G.ksq*(-6.0135255e7 + 104.*G.ksq*(274181. + 64.*G.ksq*(-1155. + 136.*G.ksq))))))))))))))))));
        }
        throw errors::BadTaylor();
        return 0;
    }


}; // namespace taylor

#endif
